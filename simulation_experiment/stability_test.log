nohup: ignoring input
/export/home/zhangyujia/anaconda3/envs/scoiget/lib/python3.8/site-packages/torch_geometric/typing.py:54: UserWarning: An issue occurred while importing 'pyg-lib'. Disabling its usage. Stacktrace: /lib64/libm.so.6: version `GLIBC_2.27' not found (required by /export/home/zhangyujia/anaconda3/envs/scoiget/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'pyg-lib'. "
/export/home/zhangyujia/anaconda3/envs/scoiget/lib/python3.8/site-packages/torch_geometric/typing.py:110: UserWarning: An issue occurred while importing 'torch-sparse'. Disabling its usage. Stacktrace: /lib64/libm.so.6: version `GLIBC_2.27' not found (required by /export/home/zhangyujia/anaconda3/envs/scoiget/lib/python3.8/site-packages/libpyg.so)
  warnings.warn(f"An issue occurred while importing 'torch-sparse'. "
... storing 'chromosome' as categorical
Using device: cuda
--- Preparing Data (Fixed for all runs) ---
Simulation parameters set. Output will be saved to ./simulation_output_fixed_improved_v2
AnnData object with n_obs × n_vars = 1600 × 5994
    obs: 'ground_truth_clone'
    var: 'gene_ids', 'chromosome', 'start', 'end'
    obsm: 'spatial'
--- Starting SCOIGET Pipeline (Final Corrected - Further Optimized) ---
Removing 0 deprecated or invalid genes.
Finished adding genomic locations with 0 errors.
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
--- Starting End-to-End Training (Similarity Enhanced - Further Optimized) ---
Training (Similarity Enhanced - Opt):   0%|          | 0/300 [00:00<?, ?it/s]Training (Similarity Enhanced - Opt):   0%|          | 1/300 [00:08<42:40,  8.56s/it]Training (Similarity Enhanced - Opt):   1%|          | 2/300 [00:14<36:09,  7.28s/it]Training (Similarity Enhanced - Opt):   1%|          | 3/300 [00:21<34:43,  7.02s/it]Training (Similarity Enhanced - Opt):   1%|▏         | 4/300 [00:28<33:29,  6.79s/it]Training (Similarity Enhanced - Opt):   2%|▏         | 5/300 [00:34<32:36,  6.63s/it]Training (Similarity Enhanced - Opt):   2%|▏         | 6/300 [00:40<32:20,  6.60s/it]Training (Similarity Enhanced - Opt):   2%|▏         | 7/300 [00:48<34:11,  7.00s/it]Training (Similarity Enhanced - Opt):   3%|▎         | 8/300 [00:55<33:15,  6.83s/it]Training (Similarity Enhanced - Opt):   3%|▎         | 9/300 [01:01<32:39,  6.73s/it]Training (Similarity Enhanced - Opt):   3%|▎         | 9/300 [01:08<32:39,  6.73s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   3%|▎         | 10/300 [01:08<32:17,  6.68s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   4%|▎         | 11/300 [01:15<32:08,  6.67s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   4%|▍         | 12/300 [01:21<31:40,  6.60s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   4%|▍         | 13/300 [01:27<31:20,  6.55s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   5%|▍         | 14/300 [01:34<31:15,  6.56s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   5%|▌         | 15/300 [01:40<30:54,  6.51s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   5%|▌         | 16/300 [01:47<30:38,  6.47s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   6%|▌         | 17/300 [01:53<30:43,  6.51s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   6%|▌         | 18/300 [02:00<30:35,  6.51s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   6%|▋         | 19/300 [02:06<30:38,  6.54s/it, Loss=1.36, Recon=0.999, Smooth=0.271, HMM_Fit=0.0429]Training (Similarity Enhanced - Opt):   6%|▋         | 19/300 [02:13<30:38,  6.54s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   7%|▋         | 20/300 [02:13<30:42,  6.58s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   7%|▋         | 21/300 [02:20<30:36,  6.58s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   7%|▋         | 22/300 [02:26<30:27,  6.57s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   8%|▊         | 23/300 [02:33<30:25,  6.59s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   8%|▊         | 24/300 [02:39<30:15,  6.58s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   8%|▊         | 25/300 [02:46<30:14,  6.60s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   9%|▊         | 26/300 [02:53<29:58,  6.56s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   9%|▉         | 27/300 [02:59<30:00,  6.60s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):   9%|▉         | 28/300 [03:06<29:59,  6.62s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):  10%|▉         | 29/300 [03:12<29:48,  6.60s/it, Loss=1.31, Recon=0.997, Smooth=0.234, HMM_Fit=0.0378]Training (Similarity Enhanced - Opt):  10%|▉         | 29/300 [03:19<29:48,  6.60s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332] Training (Similarity Enhanced - Opt):  10%|█         | 30/300 [03:19<29:41,  6.60s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  10%|█         | 31/300 [03:26<29:42,  6.63s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  11%|█         | 32/300 [03:32<29:31,  6.61s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  11%|█         | 33/300 [03:39<29:28,  6.62s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  11%|█▏        | 34/300 [03:45<29:11,  6.59s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  12%|█▏        | 35/300 [03:52<29:18,  6.64s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  12%|█▏        | 36/300 [04:00<30:27,  6.92s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  12%|█▏        | 37/300 [04:07<30:09,  6.88s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  13%|█▎        | 38/300 [04:13<29:37,  6.78s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  13%|█▎        | 39/300 [04:20<29:23,  6.76s/it, Loss=1.26, Recon=0.99, Smooth=0.202, HMM_Fit=0.0332]Training (Similarity Enhanced - Opt):  13%|█▎        | 39/300 [04:27<29:23,  6.76s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  13%|█▎        | 40/300 [04:27<29:43,  6.86s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  14%|█▎        | 41/300 [04:34<29:17,  6.79s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  14%|█▍        | 42/300 [04:41<30:05,  7.00s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  14%|█▍        | 43/300 [04:49<30:52,  7.21s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  15%|█▍        | 44/300 [04:55<29:49,  6.99s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  15%|█▌        | 45/300 [05:02<29:11,  6.87s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  15%|█▌        | 46/300 [05:08<28:38,  6.76s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  16%|█▌        | 47/300 [05:15<28:14,  6.70s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  16%|█▌        | 48/300 [05:21<27:58,  6.66s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  16%|█▋        | 49/300 [05:28<28:02,  6.70s/it, Loss=1.22, Recon=0.978, Smooth=0.182, HMM_Fit=0.0309]Training (Similarity Enhanced - Opt):  16%|█▋        | 49/300 [05:35<28:02,  6.70s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  17%|█▋        | 50/300 [05:35<27:38,  6.64s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  17%|█▋        | 51/300 [05:41<27:33,  6.64s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  17%|█▋        | 52/300 [05:48<27:24,  6.63s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  18%|█▊        | 53/300 [05:55<27:07,  6.59s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  18%|█▊        | 54/300 [06:01<27:00,  6.59s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  18%|█▊        | 55/300 [06:08<26:58,  6.61s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  19%|█▊        | 56/300 [06:14<26:51,  6.61s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  19%|█▉        | 57/300 [06:21<26:35,  6.57s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  19%|█▉        | 58/300 [06:28<26:40,  6.61s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  20%|█▉        | 59/300 [06:34<26:37,  6.63s/it, Loss=1.19, Recon=0.962, Smooth=0.166, HMM_Fit=0.0291]Training (Similarity Enhanced - Opt):  20%|█▉        | 59/300 [06:41<26:37,  6.63s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  20%|██        | 60/300 [06:41<26:27,  6.61s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  20%|██        | 61/300 [06:47<26:19,  6.61s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  21%|██        | 62/300 [06:54<26:14,  6.61s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  21%|██        | 63/300 [07:00<25:58,  6.57s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  21%|██▏       | 64/300 [07:07<25:45,  6.55s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  22%|██▏       | 65/300 [07:14<25:42,  6.56s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  22%|██▏       | 66/300 [07:20<25:31,  6.54s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  22%|██▏       | 67/300 [07:27<25:19,  6.52s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  23%|██▎       | 68/300 [07:33<25:30,  6.60s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  23%|██▎       | 69/300 [07:40<25:23,  6.59s/it, Loss=1.16, Recon=0.956, Smooth=0.148, HMM_Fit=0.0271]Training (Similarity Enhanced - Opt):  23%|██▎       | 69/300 [07:47<25:23,  6.59s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  23%|██▎       | 70/300 [07:47<25:28,  6.65s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  24%|██▎       | 71/300 [07:53<25:26,  6.67s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  24%|██▍       | 72/300 [08:00<25:19,  6.66s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  24%|██▍       | 73/300 [08:07<25:17,  6.69s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  25%|██▍       | 74/300 [08:13<25:02,  6.65s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  25%|██▌       | 75/300 [08:21<25:34,  6.82s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  25%|██▌       | 76/300 [08:27<25:12,  6.75s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  26%|██▌       | 77/300 [08:34<25:07,  6.76s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  26%|██▌       | 78/300 [08:42<26:10,  7.07s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  26%|██▋       | 79/300 [08:48<25:40,  6.97s/it, Loss=1.14, Recon=0.949, Smooth=0.138, HMM_Fit=0.0257]Training (Similarity Enhanced - Opt):  26%|██▋       | 79/300 [08:55<25:40,  6.97s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  27%|██▋       | 80/300 [08:55<25:34,  6.97s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  27%|██▋       | 81/300 [09:02<25:02,  6.86s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  27%|██▋       | 82/300 [09:10<26:28,  7.29s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  28%|██▊       | 83/300 [09:17<26:04,  7.21s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  28%|██▊       | 84/300 [09:24<25:11,  7.00s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  28%|██▊       | 85/300 [09:31<24:40,  6.89s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  29%|██▊       | 86/300 [09:37<24:31,  6.87s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  29%|██▉       | 87/300 [09:44<24:30,  6.90s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  29%|██▉       | 88/300 [09:51<24:14,  6.86s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  30%|██▉       | 89/300 [09:58<23:54,  6.80s/it, Loss=1.11, Recon=0.948, Smooth=0.118, HMM_Fit=0.0231]Training (Similarity Enhanced - Opt):  30%|██▉       | 89/300 [10:04<23:54,  6.80s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208] Training (Similarity Enhanced - Opt):  30%|███       | 90/300 [10:04<23:32,  6.72s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  30%|███       | 91/300 [10:11<23:25,  6.72s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  31%|███       | 92/300 [10:17<23:03,  6.65s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  31%|███       | 93/300 [10:24<22:45,  6.60s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  31%|███▏      | 94/300 [10:31<22:45,  6.63s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  32%|███▏      | 95/300 [10:37<22:34,  6.61s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  32%|███▏      | 96/300 [10:44<22:41,  6.67s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  32%|███▏      | 97/300 [10:52<23:36,  6.98s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  33%|███▎      | 98/300 [10:58<23:10,  6.88s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  33%|███▎      | 99/300 [11:05<22:37,  6.75s/it, Loss=1.1, Recon=0.951, Smooth=0.103, HMM_Fit=0.0208]Training (Similarity Enhanced - Opt):  33%|███▎      | 99/300 [11:11<22:37,  6.75s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  33%|███▎      | 100/300 [11:11<22:20,  6.70s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  34%|███▎      | 101/300 [11:18<21:58,  6.63s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  34%|███▍      | 102/300 [11:25<21:53,  6.63s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  34%|███▍      | 103/300 [11:31<21:40,  6.60s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  35%|███▍      | 104/300 [11:38<21:36,  6.61s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  35%|███▌      | 105/300 [11:44<21:19,  6.56s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  35%|███▌      | 106/300 [11:51<21:07,  6.53s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  36%|███▌      | 107/300 [11:57<21:08,  6.58s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  36%|███▌      | 108/300 [12:04<21:22,  6.68s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  36%|███▋      | 109/300 [12:11<21:05,  6.63s/it, Loss=1.08, Recon=0.946, Smooth=0.0956, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  36%|███▋      | 109/300 [12:17<21:05,  6.63s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  37%|███▋      | 110/300 [12:17<20:50,  6.58s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  37%|███▋      | 111/300 [12:24<20:59,  6.66s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  37%|███▋      | 112/300 [12:30<20:41,  6.60s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  38%|███▊      | 113/300 [12:37<20:35,  6.61s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  38%|███▊      | 114/300 [12:44<20:42,  6.68s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  38%|███▊      | 115/300 [12:51<20:38,  6.69s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  39%|███▊      | 116/300 [12:57<20:35,  6.72s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  39%|███▉      | 117/300 [13:04<20:24,  6.69s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  39%|███▉      | 118/300 [13:11<20:13,  6.67s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  40%|███▉      | 119/300 [13:17<20:12,  6.70s/it, Loss=1.07, Recon=0.943, Smooth=0.0885, HMM_Fit=0.0194]Training (Similarity Enhanced - Opt):  40%|███▉      | 119/300 [13:25<20:12,  6.70s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  40%|████      | 120/300 [13:25<21:08,  7.05s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  40%|████      | 121/300 [13:32<20:53,  7.00s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  41%|████      | 122/300 [13:39<20:43,  6.99s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  41%|████      | 123/300 [13:46<20:25,  6.92s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  41%|████▏     | 124/300 [13:53<20:09,  6.87s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  42%|████▏     | 125/300 [14:02<22:08,  7.59s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  42%|████▏     | 126/300 [14:09<21:08,  7.29s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  42%|████▏     | 127/300 [14:16<20:48,  7.22s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  43%|████▎     | 128/300 [14:22<20:10,  7.04s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  43%|████▎     | 129/300 [14:29<19:39,  6.90s/it, Loss=1.06, Recon=0.941, Smooth=0.0782, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  43%|████▎     | 129/300 [14:35<19:39,  6.90s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  43%|████▎     | 130/300 [14:35<19:08,  6.76s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  44%|████▎     | 131/300 [14:42<19:11,  6.81s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  44%|████▍     | 132/300 [14:49<19:11,  6.85s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  44%|████▍     | 133/300 [14:56<18:58,  6.82s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  45%|████▍     | 134/300 [15:02<18:40,  6.75s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  45%|████▌     | 135/300 [15:09<18:32,  6.74s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  45%|████▌     | 136/300 [15:16<18:12,  6.66s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  46%|████▌     | 137/300 [15:22<18:05,  6.66s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  46%|████▌     | 138/300 [15:29<17:46,  6.58s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  46%|████▋     | 139/300 [15:35<17:39,  6.58s/it, Loss=1.05, Recon=0.938, Smooth=0.0734, HMM_Fit=0.0178]Training (Similarity Enhanced - Opt):  46%|████▋     | 139/300 [15:42<17:39,  6.58s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  47%|████▋     | 140/300 [15:42<17:55,  6.72s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  47%|████▋     | 141/300 [15:49<17:34,  6.63s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  47%|████▋     | 142/300 [15:55<17:28,  6.64s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  48%|████▊     | 143/300 [16:02<17:16,  6.60s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  48%|████▊     | 144/300 [16:09<17:09,  6.60s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  48%|████▊     | 145/300 [16:15<17:06,  6.62s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  49%|████▊     | 146/300 [16:22<17:07,  6.67s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  49%|████▉     | 147/300 [16:29<16:59,  6.66s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  49%|████▉     | 148/300 [16:35<16:59,  6.71s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  50%|████▉     | 149/300 [16:42<16:46,  6.67s/it, Loss=1.04, Recon=0.933, Smooth=0.0699, HMM_Fit=0.0183]Training (Similarity Enhanced - Opt):  50%|████▉     | 149/300 [16:49<16:46,  6.67s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  50%|█████     | 150/300 [16:49<16:41,  6.67s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  50%|█████     | 151/300 [16:55<16:27,  6.63s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  51%|█████     | 152/300 [17:02<16:21,  6.63s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  51%|█████     | 153/300 [17:09<16:20,  6.67s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  51%|█████▏    | 154/300 [17:15<16:17,  6.70s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  52%|█████▏    | 155/300 [17:22<16:21,  6.77s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  52%|█████▏    | 156/300 [17:29<16:04,  6.70s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  52%|█████▏    | 157/300 [17:36<15:57,  6.70s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  53%|█████▎    | 158/300 [17:43<16:30,  6.98s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  53%|█████▎    | 159/300 [17:50<16:04,  6.84s/it, Loss=1.03, Recon=0.933, Smooth=0.0634, HMM_Fit=0.0175]Training (Similarity Enhanced - Opt):  53%|█████▎    | 159/300 [17:57<16:04,  6.84s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017] Training (Similarity Enhanced - Opt):  53%|█████▎    | 160/300 [17:57<16:01,  6.87s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  54%|█████▎    | 161/300 [18:03<15:49,  6.83s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  54%|█████▍    | 162/300 [18:10<15:40,  6.81s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  54%|█████▍    | 163/300 [18:17<15:39,  6.86s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  55%|█████▍    | 164/300 [18:24<15:27,  6.82s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  55%|█████▌    | 165/300 [18:30<15:09,  6.74s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  55%|█████▌    | 166/300 [18:37<15:00,  6.72s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  56%|█████▌    | 167/300 [18:45<15:34,  7.03s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  56%|█████▌    | 168/300 [18:52<15:20,  6.97s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  56%|█████▋    | 169/300 [18:58<15:01,  6.88s/it, Loss=1.02, Recon=0.932, Smooth=0.0585, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  56%|█████▋    | 169/300 [19:05<15:01,  6.88s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  57%|█████▋    | 170/300 [19:05<14:49,  6.84s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  57%|█████▋    | 171/300 [19:12<14:35,  6.78s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  57%|█████▋    | 172/300 [19:18<14:21,  6.73s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  58%|█████▊    | 173/300 [19:25<14:12,  6.71s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  58%|█████▊    | 174/300 [19:32<14:04,  6.70s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  58%|█████▊    | 175/300 [19:38<13:53,  6.67s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  59%|█████▊    | 176/300 [19:45<13:48,  6.68s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  59%|█████▉    | 177/300 [19:52<13:48,  6.74s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  59%|█████▉    | 178/300 [19:58<13:35,  6.69s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  60%|█████▉    | 179/300 [20:05<13:25,  6.66s/it, Loss=1.02, Recon=0.931, Smooth=0.0535, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  60%|█████▉    | 179/300 [20:12<13:25,  6.66s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  60%|██████    | 180/300 [20:12<13:24,  6.71s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  60%|██████    | 181/300 [20:19<13:24,  6.76s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  61%|██████    | 182/300 [20:25<13:12,  6.71s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  61%|██████    | 183/300 [20:32<13:05,  6.71s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  61%|██████▏   | 184/300 [20:39<13:04,  6.76s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  62%|██████▏   | 185/300 [20:46<12:57,  6.76s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  62%|██████▏   | 186/300 [20:52<12:49,  6.75s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  62%|██████▏   | 187/300 [21:00<13:01,  6.92s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  63%|██████▎   | 188/300 [21:06<12:45,  6.84s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  63%|██████▎   | 189/300 [21:13<12:33,  6.79s/it, Loss=1.01, Recon=0.929, Smooth=0.0502, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  63%|██████▎   | 189/300 [21:20<12:33,  6.79s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  63%|██████▎   | 190/300 [21:20<12:22,  6.75s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  64%|██████▎   | 191/300 [21:26<12:15,  6.75s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  64%|██████▍   | 192/300 [21:33<12:09,  6.75s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  64%|██████▍   | 193/300 [21:40<12:02,  6.75s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  65%|██████▍   | 194/300 [21:47<11:52,  6.72s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  65%|██████▌   | 195/300 [21:53<11:48,  6.74s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  65%|██████▌   | 196/300 [22:00<11:41,  6.74s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  66%|██████▌   | 197/300 [22:07<11:38,  6.78s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  66%|██████▌   | 198/300 [22:14<11:30,  6.77s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  66%|██████▋   | 199/300 [22:21<11:29,  6.83s/it, Loss=1.01, Recon=0.927, Smooth=0.0469, HMM_Fit=0.0163]Training (Similarity Enhanced - Opt):  66%|██████▋   | 199/300 [22:27<11:29,  6.83s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]   Training (Similarity Enhanced - Opt):  67%|██████▋   | 200/300 [22:27<11:18,  6.78s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  67%|██████▋   | 201/300 [22:34<11:05,  6.72s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  67%|██████▋   | 202/300 [22:41<10:57,  6.71s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  68%|██████▊   | 203/300 [22:47<10:45,  6.65s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  68%|██████▊   | 204/300 [22:54<10:36,  6.63s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  68%|██████▊   | 205/300 [23:00<10:26,  6.59s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  69%|██████▊   | 206/300 [23:07<10:22,  6.62s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  69%|██████▉   | 207/300 [23:13<10:12,  6.58s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  69%|██████▉   | 208/300 [23:20<10:13,  6.67s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  70%|██████▉   | 209/300 [23:27<09:59,  6.59s/it, Loss=1, Recon=0.926, Smooth=0.0446, HMM_Fit=0.0167]Training (Similarity Enhanced - Opt):  70%|██████▉   | 209/300 [23:33<09:59,  6.59s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  70%|███████   | 210/300 [23:33<09:53,  6.60s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  70%|███████   | 211/300 [23:40<09:42,  6.55s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  71%|███████   | 212/300 [23:46<09:32,  6.51s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  71%|███████   | 213/300 [23:53<09:21,  6.45s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  71%|███████▏  | 214/300 [23:59<09:12,  6.43s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  72%|███████▏  | 215/300 [24:06<09:12,  6.50s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  72%|███████▏  | 216/300 [24:12<09:07,  6.51s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  72%|███████▏  | 217/300 [24:20<09:28,  6.85s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  73%|███████▎  | 218/300 [24:26<09:12,  6.74s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  73%|███████▎  | 219/300 [24:33<09:07,  6.76s/it, Loss=1, Recon=0.924, Smooth=0.0431, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  73%|███████▎  | 219/300 [24:40<09:07,  6.76s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  73%|███████▎  | 220/300 [24:40<09:04,  6.80s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  74%|███████▎  | 221/300 [24:46<08:50,  6.72s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  74%|███████▍  | 222/300 [24:54<09:13,  7.09s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  74%|███████▍  | 223/300 [25:01<08:51,  6.91s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  75%|███████▍  | 224/300 [25:07<08:34,  6.77s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  75%|███████▌  | 225/300 [25:14<08:23,  6.72s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  75%|███████▌  | 226/300 [25:20<08:12,  6.66s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  76%|███████▌  | 227/300 [25:27<07:58,  6.56s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  76%|███████▌  | 228/300 [25:34<07:57,  6.63s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  76%|███████▋  | 229/300 [25:40<07:54,  6.68s/it, Loss=0.996, Recon=0.921, Smooth=0.0404, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  76%|███████▋  | 229/300 [25:47<07:54,  6.68s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  77%|███████▋  | 230/300 [25:47<07:44,  6.64s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  77%|███████▋  | 231/300 [25:54<07:37,  6.63s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  77%|███████▋  | 232/300 [26:00<07:33,  6.68s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  78%|███████▊  | 233/300 [26:07<07:32,  6.76s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  78%|███████▊  | 234/300 [26:14<07:22,  6.70s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  78%|███████▊  | 235/300 [26:21<07:16,  6.72s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  79%|███████▊  | 236/300 [26:27<07:09,  6.71s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  79%|███████▉  | 237/300 [26:34<06:57,  6.62s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  79%|███████▉  | 238/300 [26:40<06:48,  6.59s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  80%|███████▉  | 239/300 [26:47<06:39,  6.55s/it, Loss=0.991, Recon=0.919, Smooth=0.0373, HMM_Fit=0.0168]Training (Similarity Enhanced - Opt):  80%|███████▉  | 239/300 [26:53<06:39,  6.55s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]  Training (Similarity Enhanced - Opt):  80%|████████  | 240/300 [26:53<06:30,  6.51s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  80%|████████  | 241/300 [26:59<06:22,  6.48s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  81%|████████  | 242/300 [27:06<06:14,  6.46s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  81%|████████  | 243/300 [27:12<06:06,  6.44s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  81%|████████▏ | 244/300 [27:19<06:01,  6.45s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  82%|████████▏ | 245/300 [27:25<05:55,  6.47s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  82%|████████▏ | 246/300 [27:32<05:47,  6.44s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  82%|████████▏ | 247/300 [27:38<05:41,  6.44s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  83%|████████▎ | 248/300 [27:44<05:33,  6.42s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  83%|████████▎ | 249/300 [27:51<05:27,  6.41s/it, Loss=0.991, Recon=0.92, Smooth=0.0356, HMM_Fit=0.017]Training (Similarity Enhanced - Opt):  83%|████████▎ | 249/300 [27:57<05:27,  6.41s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  83%|████████▎ | 250/300 [27:57<05:21,  6.43s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  84%|████████▎ | 251/300 [28:04<05:18,  6.49s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  84%|████████▍ | 252/300 [28:10<05:11,  6.49s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  84%|████████▍ | 253/300 [28:17<05:04,  6.47s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  85%|████████▍ | 254/300 [28:23<04:56,  6.45s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  85%|████████▌ | 255/300 [28:30<04:52,  6.49s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  85%|████████▌ | 256/300 [28:36<04:44,  6.47s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  86%|████████▌ | 257/300 [28:43<04:36,  6.43s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  86%|████████▌ | 258/300 [28:49<04:33,  6.51s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  86%|████████▋ | 259/300 [28:56<04:25,  6.47s/it, Loss=0.99, Recon=0.914, Smooth=0.0368, HMM_Fit=0.0191]Training (Similarity Enhanced - Opt):  86%|████████▋ | 259/300 [29:02<04:25,  6.47s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  87%|████████▋ | 260/300 [29:02<04:17,  6.45s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  87%|████████▋ | 261/300 [29:08<04:10,  6.41s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  87%|████████▋ | 262/300 [29:15<04:03,  6.40s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  88%|████████▊ | 263/300 [29:21<03:57,  6.42s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  88%|████████▊ | 264/300 [29:28<03:50,  6.41s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  88%|████████▊ | 265/300 [29:34<03:44,  6.41s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  89%|████████▊ | 266/300 [29:40<03:37,  6.41s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  89%|████████▉ | 267/300 [29:47<03:32,  6.43s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  89%|████████▉ | 268/300 [29:53<03:26,  6.45s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  90%|████████▉ | 269/300 [30:00<03:24,  6.58s/it, Loss=0.987, Recon=0.91, Smooth=0.0367, HMM_Fit=0.0199]Training (Similarity Enhanced - Opt):  90%|████████▉ | 269/300 [30:07<03:24,  6.58s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]  Training (Similarity Enhanced - Opt):  90%|█████████ | 270/300 [30:07<03:16,  6.54s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  90%|█████████ | 271/300 [30:13<03:11,  6.59s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  91%|█████████ | 272/300 [30:20<03:03,  6.56s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  91%|█████████ | 273/300 [30:26<02:56,  6.54s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  91%|█████████▏| 274/300 [30:33<02:49,  6.50s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  92%|█████████▏| 275/300 [30:39<02:41,  6.45s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  92%|█████████▏| 276/300 [30:46<02:34,  6.42s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  92%|█████████▏| 277/300 [30:52<02:27,  6.40s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  93%|█████████▎| 278/300 [30:58<02:21,  6.45s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  93%|█████████▎| 279/300 [31:05<02:15,  6.46s/it, Loss=0.985, Recon=0.908, Smooth=0.036, HMM_Fit=0.02]Training (Similarity Enhanced - Opt):  93%|█████████▎| 279/300 [31:12<02:15,  6.46s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  93%|█████████▎| 280/300 [31:12<02:12,  6.62s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  94%|█████████▎| 281/300 [31:19<02:08,  6.76s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  94%|█████████▍| 282/300 [31:26<02:00,  6.69s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  94%|█████████▍| 283/300 [31:32<01:52,  6.61s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  95%|█████████▍| 284/300 [31:38<01:44,  6.56s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  95%|█████████▌| 285/300 [31:45<01:37,  6.48s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  95%|█████████▌| 286/300 [31:51<01:30,  6.44s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  96%|█████████▌| 287/300 [31:58<01:23,  6.43s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  96%|█████████▌| 288/300 [32:04<01:16,  6.42s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  96%|█████████▋| 289/300 [32:10<01:10,  6.43s/it, Loss=0.984, Recon=0.908, Smooth=0.0333, HMM_Fit=0.0211]Training (Similarity Enhanced - Opt):  96%|█████████▋| 289/300 [32:17<01:10,  6.43s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  97%|█████████▋| 290/300 [32:17<01:04,  6.43s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  97%|█████████▋| 291/300 [32:23<00:57,  6.44s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  97%|█████████▋| 292/300 [32:30<00:51,  6.41s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  98%|█████████▊| 293/300 [32:36<00:44,  6.39s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  98%|█████████▊| 294/300 [32:42<00:38,  6.36s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  98%|█████████▊| 295/300 [32:49<00:31,  6.35s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  99%|█████████▊| 296/300 [32:55<00:25,  6.37s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  99%|█████████▉| 297/300 [33:02<00:19,  6.43s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt):  99%|█████████▉| 298/300 [33:08<00:12,  6.41s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt): 100%|█████████▉| 299/300 [33:14<00:06,  6.43s/it, Loss=0.984, Recon=0.904, Smooth=0.0336, HMM_Fit=0.0222]Training (Similarity Enhanced - Opt): 100%|█████████▉| 299/300 [33:22<00:06,  6.43s/it, Loss=0.979, Recon=0.902, Smooth=0.0308, HMM_Fit=0.0223]Training (Similarity Enhanced - Opt): 100%|██████████| 300/300 [33:22<00:00,  6.68s/it, Loss=0.979, Recon=0.902, Smooth=0.0308, HMM_Fit=0.0223]Training (Similarity Enhanced - Opt): 100%|██████████| 300/300 [33:22<00:00,  6.67s/it, Loss=0.979, Recon=0.902, Smooth=0.0308, HMM_Fit=0.0223]... storing 'chromosome' as categorical

Training complete. Getting final CNV...
Running K-Means clustering on CNV results...
--- SCOIGET Pipeline Complete ---
--- Evaluating and Visualizing Results (Final Polishing and Plot Fix) ---
--- Final Metrics ---
MSE: 0.0494
Cosine Similarity: 0.1218
Final enhanced visualization saved to ./simulation_output_fixed_improved_v2/Supplementary_Figure_S1_Similarity_Optimized.png
Removing 0 deprecated or invalid genes.
Finished adding genomic locations with 0 errors.
--- Reconstructing Ground Truth for Evaluation ---

--- Starting Stability Test across 5 seeds ---

=== Starting Run with Seed: 42 ===
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
Seed 42 -> MSE: 0.03163, Cosine Sim: 0.62931

=== Starting Run with Seed: 123 ===
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
Seed 123 -> MSE: 0.03226, Cosine Sim: 0.62842

=== Starting Run with Seed: 2024 ===
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
Seed 2024 -> MSE: 0.03219, Cosine Sim: 0.62697

=== Starting Run with Seed: 7 ===
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
Seed 7 -> MSE: 0.03200, Cosine Sim: 0.62824

=== Starting Run with Seed: 99 ===
x shape: torch.Size([1600, 236])
edge_index shape: torch.Size([2, 12800])
edge_attr shape: torch.Size([12800])
Seed 99 -> MSE: 0.03212, Cosine Sim: 0.62753

========================================
STABILITY TEST RESULTS
========================================
Seeds used: [42, 123, 2024, 7, 99]
MSE: 0.0320 ± 0.0002
Cosine Similarity: 0.6281 ± 0.0008
========================================
